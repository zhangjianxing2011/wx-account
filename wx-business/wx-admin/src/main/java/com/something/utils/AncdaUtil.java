package com.something.utils;

import com.something.core.exception.MyException;
import com.alibaba.fastjson2.JSONObject;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

import java.util.HashMap;
import java.util.Map;

@Slf4j
@Component
public class AncdaUtil {
    //按天查询考勤
    private static final String singleSignURL = "https://kid-app-api.ancda.com/v1/affairs/attendance/record/myCheckin";
    //按月查询考勤
    private static final String monthSignURL = "https://kid-app-api.ancda.com/v1/affairs/attendance/statistic/calendar";
    //按月查询餐食
    private static final String monthMeatURL = "https://kid-app-api.ancda.com/v1/safe/food/cookbooks/info";


    @Value("${custom.authorization}")
    private String authorization;
    @Value("${custom.static-user}")
    private String staticUser;
    @Value("${custom.static-role}")
    private String staticRole;


    /**
     * @param date yyyy-MM-dd
     * @return {"data":{"classes":[{"name":"张三", "avatar":"", "userId":"123456789xxx", "status":4, "isDisinfect":0, "signDate":"2025-05-08T00:00:00+08:00", "signTime":"", "signCapture":[], "attendanceType":0, "accessSign":1, "temperature":0, "workTime":"08:30:00", "timeSlotNum":1, "recordId":"123456789xxx", "applyStatus":0, "machineType":"", "isLeave":0}, {"name":"张三", "avatar":"", "userId":"123456789xxx", "status":1, "isDisinfect":0, "signDate":"2025-05-08T00:00:00+08:00", "signTime":"16:42:45", "signCapture":["http://mediatx.ancda.com/123456789.jpg"], "attendanceType":0, "accessSign":0, "temperature":0, "workTime":"16:00:00", "timeSlotNum":2, "recordId":"123456", "applyStatus":0, "machineType":"立式考勤机", "isLeave":0}], "leave":[]}}
     */
    public String getSingleSign(String date) {
        try {
            String parameters = "?date=" + date + "&userId=" + staticUser + "&userRole=" + staticRole;
            String url = singleSignURL + parameters;
            log.info("url:{}", url);
            return OkHttpUtils.getWithHeaders(url, getHeaders(true));
        } catch (Exception e) {
            throw new MyException(500, e.getMessage());
        }
    }

    /**
     * 嘿！没有给指定的返回的Content-Encoding: gzip,导致乱码
     *
     * @param date 格式 yyyy-MM
     * @return {"data":{"calendar":[{"day":1, "startTime":"", "endTime":"", "status":2, "isWork":1}, {"day":2, "startTime":"", "endTime":"", "status":2, "isWork":1}, {"day":3, "startTime":"", "endTime":"", "status":2, "isWork":1}, {"day":4, "startTime":"", "endTime":"", "status":0, "isWork":0}, {"day":5, "startTime":"", "endTime":"", "status":0, "isWork":0}, {"day":6, "startTime":"", "endTime":"", "status":0, "isWork":0}, {"day":7, "startTime":"", "endTime":"16:40", "status":0, "isWork":1}, {"day":8, "startTime":"", "endTime":"16:41", "status":0, "isWork":1}, {"day":9, "startTime":"", "endTime":"16:43", "status":0, "isWork":1}, {"day":10, "startTime":"", "endTime":"16:43", "status":0, "isWork":1}, {"day":11, "startTime":"", "endTime":"", "status":2, "isWork":1}, {"day":12, "startTime":"", "endTime":"", "status":0, "isWork":0}, {"day":13, "startTime":"", "endTime":"", "status":0, "isWork":0}, {"day":14, "startTime":"", "endTime":"16:43", "status":0, "isWork":1}, {"day":15, "startTime":"", "endTime":"16:44", "status":0, "isWork":1}, {"day":16, "startTime":"", "endTime":"16:43", "status":0, "isWork":1}, {"day":17, "startTime":"", "endTime":"16:44", "status":0, "isWork":1}, {"day":18, "startTime":"", "endTime":"16:46", "status":0, "isWork":1}, {"day":19, "startTime":"", "endTime":"", "status":0, "isWork":0}, {"day":20, "startTime":"", "endTime":"", "status":0, "isWork":0}, {"day":21, "startTime":"", "endTime":"16:44", "status":0, "isWork":1}, {"day":22, "startTime":"", "endTime":"16:44", "status":0, "isWork":1}, {"day":23, "startTime":"", "endTime":"16:45", "status":0, "isWork":1}, {"day":24, "startTime":"", "endTime":"16:42", "status":0, "isWork":1}, {"day":25, "startTime":"", "endTime":"16:42", "status":0, "isWork":1}, {"day":26, "startTime":"", "endTime":"", "status":0, "isWork":0}, {"day":27, "startTime":"", "endTime":"", "status":0, "isWork":0}, {"day":28, "startTime":"", "endTime":"16:42", "status":0, "isWork":1}, {"day":29, "startTime":"", "endTime":"16:40", "status":0, "isWork":1}, {"day":30, "startTime":"", "endTime":"16:42", "status":0, "isWork":1}], "attendCount":[{"headCount":0, "attendCount":17, "absenteeismCount":4, "leaveCount":0, "beLateCount":0, "leaveEarlyCount":0, "missCount":17, "title":"", "classId":"", "gradeName":"", "gradeId":""}]}}
     */
    public String getMonthSign(String date) {
        try {
            Map<String, String> map = getHeaders(true);
            map.put("accept", "*/*");
            log.info("headers:{}", JSONObject.toJSONString(map));
            String parameters = "?month=" + date + "&statisUser=" + staticUser + "&statisRole=" + staticRole;
            String url = monthSignURL + parameters;

            log.info("url:{}", url);
            return OkHttpUtils.getWithHeadersAndUnzipBody(url, map);
        } catch (Exception e) {
            throw new MyException(500, e.getMessage());
        }
    }

    /**
     * @param month yyyy-MM
     * @return {"list":[{"cookDate":"2025-05-05", "cookNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "cookPictureList":[], "dishList":[]}, {"cookDate":"2025-05-06", "cookNutrition":{"energy":98.84, "protein":4.28, "carbohydrate":20.46, "fat":1.09, "fiber":2.16, "va":34.5, "vb1":0.03, "vb3":0.74, "ve":0.27, "carotene":137, "vb2":0.12, "vc":0.2, "ca":29.2, "k":187.3, "mg":11, "zn":0.3, "cu":0.18, "i":0, "p":41.5, "na":77.63, "fe":5.59, "se":1.44, "mn":0.43}, "cookPictureList":[], "dishList":[{"id":"2056726", "dishName":"纯牛奶 ", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"早餐", "mealSort":1, "ingredientList":[]}, {"id":"1359551", "dishName":"安德鲁森白吐司", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"早餐", "mealSort":1, "ingredientList":[]}, {"id":"2056727", "dishName":"清香白米饭", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午餐", "mealSort":3, "ingredientList":[]}, {"id":"1354611", "dishName":"香卤鸡腿", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午餐", "mealSort":3, "ingredientList":[]}, {"id":"1354963", "dishName":"肉沫茄子", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午餐", "mealSort":3, "ingredientList":[]}, {"id":"1357372", "dishName":"炝炒油麦菜", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午餐", "mealSort":3, "ingredientList":[]}, {"id":"2931", "dishName":"紫菜蛋花汤", "dishNutrition":{"energy":32.2, "protein":3.335, "carbohydrate":4.5499997, "fat":0.55, "fiber":2.16, "va":34.5, "vb1":0.032500003, "vb3":0.74, "ve":0.27400002, "carotene":137, "vb2":0.115499996, "vc":0.2, "ca":29.199999, "k":187.3, "mg":11, "zn":0.30200002, "cu":0.1755, "i":0, "p":41.5, "na":77.625, "fe":5.59, "se":1.439, "mn":0.43400002}, "mealName":"午餐", "mealSort":3, "ingredientList":[{"id":"0", "ingredientId":"618", "ingredientName":"紫菜(干)", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":10, "diet":{"energy":250, "protein":26.7, "carbohydrate":44.1, "fat":1.1, "fiber":21.6, "va":228, "vb1":0.27, "vb3":7.3, "ve":1.82, "carotene":1370, "vb2":1.02, "vc":2, "ca":264, "k":1796, "mg":105, "zn":2.47, "cu":1.68, "i":0, "p":350, "na":710.5, "fe":54.9, "se":7.22, "mn":4.32}}, {"id":"0", "ingredientId":"1209", "ingredientName":"鸡蛋", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":5, "diet":{"energy":144, "protein":13.3, "carbohydrate":2.8, "fat":8.8, "fiber":0, "va":234, "vb1":0.11, "vb3":0.2, "ve":1.84, "carotene":0, "vb2":0.27, "vc":0, "ca":56, "k":154, "mg":10, "zn":1.1, "cu":0.15, "i":0, "p":130, "na":131.5, "fe":2, "se":14.34, "mn":0.04}}]}, {"id":"642", "dishName":"苹果", "dishNutrition":{"energy":78.4, "protein":1.12, "carbohydrate":18.72, "fat":0.64000005, "fiber":3.36, "va":16, "vb1":0.016, "vb3":0, "ve":2.3360002, "carotene":96, "vb2":0, "vc":3.2, "ca":4.8, "k":184, "mg":8, "zn":0, "cu":0.096, "i":0, "p":17.6, "na":1.12, "fe":1.12, "se":1.5680001, "mn":0.080000006}, "mealName":"水果", "mealSort":3, "ingredientList":[{"id":"0", "ingredientId":"628", "ingredientName":"红富士苹果", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":160, "diet":{"energy":49, "protein":0.7, "carbohydrate":11.7, "fat":0.4, "fiber":2.1, "va":10, "vb1":0.01, "vb3":0, "ve":1.46, "carotene":60, "vb2":0, "vc":2, "ca":3, "k":115, "mg":5, "zn":0, "cu":0.06, "i":0, "p":11, "na":0.7, "fe":0.7, "se":0.98, "mn":0.05}}]}, {"id":"2056728", "dishName":"鲜蔬蝴蝶面", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午点", "mealSort":4, "ingredientList":[]}]}, {"cookDate":"2025-05-07", "cookNutrition":{"energy":272.07, "protein":6.9, "carbohydrate":16.23, "fat":20.1, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "cookPictureList":[], "dishList":[{"id":"2056729", "dishName":"香甜玉米汁", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"早餐", "mealSort":1, "ingredientList":[]}, {"id":"1356799", "dishName":"核桃包", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"早餐", "mealSort":1, "ingredientList":[]}, {"id":"1357216", "dishName":"红米米饭", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午餐", "mealSort":3, "ingredientList":[]}, {"id":"2391", "dishName":"土豆烧肉", "dishNutrition":{"energy":241.45, "protein":6.28, "carbohydrate":9.56, "fat":19.895, "fiber":0.35, "va":9.7, "vb1":0.128, "vb3":1.95, "ve":4.964, "carotene":15, "vb2":0.084, "vc":13.5, "ca":7.05, "k":252.75, "mg":18.05, "zn":1.0634999, "cu":0.092, "i":0, "p":85.15, "na":25.355001, "fe":1.1400001, "se":5.178, "mn":0.1035}, "mealName":"午餐", "mealSort":3, "ingredientList":[{"id":"0", "ingredientId":"141", "ingredientName":"马铃薯[土豆，洋芋]", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":50, "diet":{"energy":77, "protein":2, "carbohydrate":17.2, "fat":0.2, "fiber":0.7, "va":5, "vb1":0.08, "vb3":1.1, "ve":0.34, "carotene":30, "vb2":0.04, "vc":27, "ca":8, "k":342, "mg":23, "zn":0.37, "cu":0.12, "i":0, "p":40, "na":2.7, "fe":0.8, "se":0.78, "mn":0.14}}, {"id":"0", "ingredientId":"862", "ingredientName":"猪肉(肥瘦)", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":40, "diet":{"energy":395, "protein":13.2, "carbohydrate":2.4, "fat":37, "fiber":0, "va":18, "vb1":0.22, "vb3":3.5, "ve":0.35, "carotene":0, "vb2":0.16, "vc":0, "ca":6, "k":204, "mg":16, "zn":2.06, "cu":0.06, "i":0, "p":162, "na":59.4, "fe":1.6, "se":11.97, "mn":0.03}}, {"id":"0", "ingredientId":"2030", "ingredientName":"豆油", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":5, "diet":{"energy":899, "protein":0, "carbohydrate":0, "fat":99.9, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":93.08, "carotene":0, "vb2":0, "vc":0, "ca":13, "k":3, "mg":3, "zn":1.09, "cu":0.16, "i":0, "p":7, "na":4.9, "fe":2, "se":0, "mn":0.43}}]}, {"id":"2349", "dishName":"西红柿炒鸡蛋", "dishNutrition":{"energy":3.4199998, "protein":0.22299999, "carbohydrate":0.35, "fat":0.126, "fiber":0, "va":2.1599998, "vb1":0.0032999997, "vb3":0.018, "ve":0, "carotene":0, "vb2":0.0065, "vc":0.11, "ca":6.66, "k":10.74, "mg":2.1, "zn":0.029199999, "cu":0.0045999996, "i":0, "p":3.54, "na":42.642, "fe":0.038, "se":0.1416, "mn":0.0094}, "mealName":"午餐", "mealSort":3, "ingredientList":[{"id":"0", "ingredientId":"1131", "ingredientName":"牛乳(美国牛)", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":2, "diet":{"energy":59, "protein":2.9, "carbohydrate":4.6, "fat":3.2, "fiber":0, "va":9, "vb1":0.13, "vb3":0, "ve":0, "carotene":0, "vb2":0.18, "vc":1, "ca":108, "k":127, "mg":19, "zn":0.33, "cu":0.14, "i":0, "p":68, "na":40.2, "fe":0.1, "se":2.38, "mn":0.01}}, {"id":"0", "ingredientId":"1132", "ingredientName":"牛乳(强化VA，VD)", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":3, "diet":{"energy":51, "protein":2.7, "carbohydrate":5.6, "fat":2, "fiber":0, "va":66, "vb1":0.02, "vb3":0.1, "ve":0, "carotene":0, "vb2":0.08, "vc":3, "ca":140, "k":130, "mg":14, "zn":0.38, "cu":0.04, "i":0, "p":60, "na":42.6, "fe":0.2, "se":1.36, "mn":0.03}}, {"id":"0", "ingredientId":"2052", "ingredientName":"酱油(高级)", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":1, "diet":{"energy":71, "protein":8.4, "carbohydrate":9, "fat":0.2, "fiber":0, "va":0, "vb1":0.01, "vb3":1.5, "ve":0, "carotene":0, "vb2":0.05, "vc":0, "ca":30, "k":430, "mg":130, "zn":1.12, "cu":0.06, "i":0, "p":38, "na":4056, "fe":3, "se":5.32, "mn":0.83}}]}, {"id":"1355311", "dishName":"炝炒上海青", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午餐", "mealSort":3, "ingredientList":[]}, {"id":"2056731", "dishName":"玉米筒骨汤", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午餐", "mealSort":3, "ingredientList":[]}, {"id":"626", "dishName":"哈密瓜", "dishNutrition":{"energy":27.2, "protein":0.4, "carbohydrate":6.32, "fat":0.080000006, "fiber":0, "va":61.600002, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":9.6, "ca":3.2, "k":152, "mg":15.2, "zn":0.080000006, "cu":0, "i":0, "p":15.2, "na":21.36, "fe":0, "se":0.88000005, "mn":0}, "mealName":"水果", "mealSort":4, "ingredientList":[{"id":"0", "ingredientId":"2675", "ingredientName":"西州蜜[哈密瓜]", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":80, "diet":{"energy":34, "protein":0.5, "carbohydrate":7.9, "fat":0.1, "fiber":0, "va":77, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":12, "ca":4, "k":190, "mg":19, "zn":0.1, "cu":0, "i":0, "p":19, "na":26.7, "fe":0, "se":1.1, "mn":0}}]}, {"id":"1359034", "dishName":"健脾山药粥", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午点", "mealSort":5, "ingredientList":[]}]}, {"cookDate":"2025-05-08", "cookNutrition":{"energy":570.36, "protein":27.5, "carbohydrate":41.9, "fat":33.73, "fiber":2.37, "va":795.95, "vb1":0.46, "vb3":3.34, "ve":8.59, "carotene":4018, "vb2":0.26, "vc":28.8, "ca":346.03, "k":543.42, "mg":89.73, "zn":3.6, "cu":0.43, "i":0, "p":453.86, "na":645.75, "fe":3.77, "se":43.75, "mn":0.85}, "cookPictureList":[], "dishList":[{"id":"1716", "dishName":"纯牛奶", "dishNutrition":{"energy":123.84, "protein":6.8040004, "carbohydrate":10.7560005, "fat":6.4, "fiber":0, "va":48, "vb1":0, "vb3":0.008, "ve":0.42, "carotene":0, "vb2":0, "vc":2, "ca":208.24, "k":218.08, "mg":22.08, "zn":0.84279996, "cu":0.040799998, "i":0, "p":146.12, "na":74.48, "fe":0.60800004, "se":23.895199, "mn":0.0632}, "mealName":"早餐", "mealSort":1, "ingredientList":[{"id":"0", "ingredientId":"1958", "ingredientName":"绵白糖", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":4, "diet":{"energy":396, "protein":0.1, "carbohydrate":98.9, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0.2, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":6, "k":2, "mg":2, "zn":0.07, "cu":0.02, "i":0, "p":3, "na":2, "fe":0.2, "se":0.38, "mn":0.08}}, {"id":"0", "ingredientId":"2259", "ingredientName":"纯牛奶", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":200, "diet":{"energy":54, "protein":3.4, "carbohydrate":3.4, "fat":3.2, "fiber":0, "va":24, "vb1":0, "vb3":0, "ve":0.21, "carotene":0, "vb2":0, "vc":1, "ca":104, "k":109, "mg":11, "zn":0.42, "cu":0.02, "i":0, "p":73, "na":37.2, "fe":0.3, "se":11.94, "mn":0.03}}]}, {"id":"1358459", "dishName":"香菇素菜包", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"早餐", "mealSort":1, "ingredientList":[]}, {"id":"1354557", "dishName":"喷香白米饭", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午餐", "mealSort":3, "ingredientList":[]}, {"id":"1066", "dishName":"炸猪排", "dishNutrition":{"energy":58.9, "protein":0.83500004, "carbohydrate":0.04, "fat":6.15, "fiber":0, "va":0.25, "vb1":0.015000001, "vb3":0.22500001, "ve":5.153, "carotene":0, "vb2":0.008, "vc":0, "ca":0.75, "k":11.55, "mg":0.75, "zn":0.2585, "cu":0.0085, "i":0, "p":6.75, "na":3.5849998, "fe":0.085, "se":0.5525, "mn":0.001}, "mealName":"午餐", "mealSort":3, "ingredientList":[{"id":"0", "ingredientId":"880", "ingredientName":"猪小排", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":5, "diet":{"energy":278, "protein":16.7, "carbohydrate":0.7, "fat":23.1, "fiber":0, "va":5, "vb1":0.3, "vb3":4.5, "ve":0.11, "carotene":0, "vb2":0.16, "vc":0, "ca":14, "k":230, "mg":14, "zn":3.36, "cu":0.17, "i":0, "p":135, "na":62.6, "fe":1.4, "se":11.05, "mn":0.02}}, {"id":"0", "ingredientId":"2050", "ingredientName":"大豆色拉油", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":5, "diet":{"energy":900, "protein":0, "carbohydrate":0.1, "fat":99.9, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":102.95, "carotene":0, "vb2":0, "vc":0, "ca":1, "k":1, "mg":1, "zn":1.81, "cu":0, "i":0, "p":0, "na":9.1, "fe":0.3, "se":0, "mn":0}}]}, {"id":"2869", "dishName":"肉沫蒸蛋", "dishNutrition":{"energy":103.200005, "protein":6.245, "carbohydrate":0.7, "fat":8.36, "fiber":0, "va":61.7, "vb1":0.0795, "vb3":0.61, "ve":0.65, "carotene":0, "vb2":0.0895, "vc":0, "ca":15, "k":74.100006, "mg":4.9, "zn":0.44300002, "cu":0.0635, "i":0, "p":58.5, "na":44.375, "fe":0.7, "se":4.173, "mn":0.01}, "mealName":"午餐", "mealSort":3, "ingredientList":[{"id":"0", "ingredientId":"864", "ingredientName":"猪肉(后臀尖)", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":20, "diet":{"energy":336, "protein":14.6, "carbohydrate":0, "fat":30.8, "fiber":0, "va":16, "vb1":0.26, "vb3":2.8, "ve":0.95, "carotene":0, "vb2":0.11, "vc":0, "ca":5, "k":178, "mg":12, "zn":0.84, "cu":0.13, "i":0, "p":130, "na":57.5, "fe":1, "se":2.94, "mn":0}}, {"id":"0", "ingredientId":"1209", "ingredientName":"鸡蛋", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":25, "diet":{"energy":144, "protein":13.3, "carbohydrate":2.8, "fat":8.8, "fiber":0, "va":234, "vb1":0.11, "vb3":0.2, "ve":1.84, "carotene":0, "vb2":0.27, "vc":0, "ca":56, "k":154, "mg":10, "zn":1.1, "cu":0.15, "i":0, "p":130, "na":131.5, "fe":2, "se":14.34, "mn":0.04}}]}, {"id":"1584", "dishName":"清炒西兰花", "dishNutrition":{"energy":21.9, "protein":2.1499999, "carbohydrate":3.0300002, "fat":0.32000002, "fiber":0.91, "va":669.8, "vb1":0.049000002, "vb3":0.51, "ve":0.49600002, "carotene":4018, "vb2":0.067999996, "vc":26.8, "ca":36.7, "k":27.5, "mg":9.9, "zn":0.413, "cu":0.023, "i":0, "p":38.7, "na":16.54, "fe":0.6, "se":0.413, "mn":0.144}, "mealName":"午餐", "mealSort":3, "ingredientList":[{"id":"0", "ingredientId":"262", "ingredientName":"胡萝卜(红)[金笋，丁香萝卜]", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":10, "diet":{"energy":39, "protein":1, "carbohydrate":8.8, "fat":0.2, "fiber":1.1, "va":688, "vb1":0.04, "vb3":0.6, "ve":0.41, "carotene":4130, "vb2":0.03, "vc":13, "ca":32, "k":190, "mg":14, "zn":0.23, "cu":0.08, "i":0, "p":27, "na":71.4, "fe":1, "se":0.63, "mn":0.24}}, {"id":"0", "ingredientId":"387", "ingredientName":"西兰花[绿菜花]", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":50, "diet":{"energy":36, "protein":4.1, "carbohydrate":4.3, "fat":0.6, "fiber":1.6, "va":1202, "vb1":0.09, "vb3":0.9, "ve":0.91, "carotene":7210, "vb2":0.13, "vc":51, "ca":67, "k":17, "mg":17, "zn":0.78, "cu":0.03, "i":0, "p":72, "na":18.8, "fe":1, "se":0.7, "mn":0.24}}]}, {"id":"2056735", "dishName":"冬瓜丸子瘦肉汤", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午餐", "mealSort":3, "ingredientList":[]}, {"id":"1354421", "dishName":"香蕉", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"水果", "mealSort":4, "ingredientList":[]}, {"id":"1700", "dishName":"三鲜烧麦", "dishNutrition":{"energy":262.52002, "protein":11.467, "carbohydrate":27.372, "fat":12.496, "fiber":1.4629999, "va":16.2, "vb1":0.3118, "vb3":1.9813, "ve":1.8651999, "carotene":0, "vb2":0.0886, "vc":0, "ca":85.34, "k":212.18999, "mg":52.100002, "zn":1.6549999, "cu":0.2979, "i":0, "p":203.79001, "na":506.775, "fe":1.784, "se":14.7226, "mn":0.6438}, "mealName":"午点", "mealSort":5, "ingredientList":[{"id":"0", "ingredientId":"35", "ingredientName":"小麦胚粉", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":3, "diet":{"energy":392, "protein":36.4, "carbohydrate":38.9, "fat":10.1, "fiber":5.6, "va":0, "vb1":3.5, "vb3":3.7, "ve":23.2, "carotene":0, "vb2":0.79, "vc":0, "ca":85, "k":1523, "mg":198, "zn":23.4, "cu":0.83, "i":0, "p":1168, "na":4.6, "fe":0.6, "se":65.2, "mn":17.3}}, {"id":"0", "ingredientId":"37", "ingredientName":"小麦面粉(标准粉)", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":35, "diet":{"energy":354, "protein":15.7, "carbohydrate":70.9, "fat":2.5, "fiber":3.7, "va":0, "vb1":0.46, "vb3":1.91, "ve":0.32, "carotene":0, "vb2":0.05, "vc":0, "ca":31, "k":190, "mg":50, "zn":0.2, "cu":0.06, "i":0, "p":167, "na":3.1, "fe":0.6, "se":7.42, "mn":0.1}}, {"id":"0", "ingredientId":"862", "ingredientName":"猪肉(肥瘦)", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":20, "diet":{"energy":395, "protein":13.2, "carbohydrate":2.4, "fat":37, "fiber":0, "va":18, "vb1":0.22, "vb3":3.5, "ve":0.35, "carotene":0, "vb2":0.16, "vc":0, "ca":6, "k":204, "mg":16, "zn":2.06, "cu":0.06, "i":0, "p":162, "na":59.4, "fe":1.6, "se":11.97, "mn":0.03}}, {"id":"0", "ingredientId":"1158", "ingredientName":"全脂奶粉(伊利牌)", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":2, "diet":{"energy":504, "protein":22, "carbohydrate":45.5, "fat":26, "fiber":0, "va":525, "vb1":0.04, "vb3":0.09, "ve":0, "carotene":0, "vb2":0.17, "vc":0, "ca":750, "k":209, "mg":91, "zn":3.97, "cu":0.2, "i":0, "p":550, "na":220.6, "fe":3.9, "se":11.78, "mn":0.01}}, {"id":"0", "ingredientId":"1359", "ingredientName":"虾仁", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":10, "diet":{"energy":198, "protein":18, "carbohydrate":0, "fat":14, "fiber":0, "va":21, "vb1":0.01, "vb3":5, "ve":1.46, "carotene":0, "vb2":0.12, "vc":0, "ca":555, "k":550, "mg":236, "zn":3.82, "cu":2.33, "i":0, "p":666, "na":4891.9, "fe":11, "se":75.4, "mn":0.77}}, {"id":"0", "ingredientId":"2033", "ingredientName":"花生油", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":2, "diet":{"energy":899, "protein":0, "carbohydrate":0, "fat":99.9, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":42.06, "carotene":0, "vb2":0, "vc":0, "ca":12, "k":1, "mg":2, "zn":0.48, "cu":0.15, "i":0, "p":15, "na":3.5, "fe":2.9, "se":0, "mn":0.33}}]}, {"id":"1360361", "dishName":"云吞", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午点", "mealSort":5, "ingredientList":[]}]}, {"cookDate":"2025-05-09", "cookNutrition":{"energy":52.78, "protein":1.14, "carbohydrate":13.77, "fat":0.21, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "cookPictureList":[], "dishList":[{"id":"2056736", "dishName":"南瓜子豆浆", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"早餐", "mealSort":1, "ingredientList":[]}, {"id":"2056737", "dishName":"千叶玉米味米糕", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"早餐", "mealSort":1, "ingredientList":[]}, {"id":"2056738", "dishName":"什锦焖饭", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午餐", "mealSort":3, "ingredientList":[]}, {"id":"2056739", "dishName":"牛骨萝卜汤", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午餐", "mealSort":3, "ingredientList":[]}, {"id":"1116", "dishName":"火龙果", "dishNutrition":{"energy":76.5, "protein":1.6500001, "carbohydrate":19.95, "fat":0.3, "fiber":3, "va":0, "vb1":0.044999998, "vb3":0.32999998, "ve":0.21000001, "carotene":0, "vb2":0.03, "vc":4.5, "ca":10.5, "k":30, "mg":45, "zn":0.435, "cu":0.06, "i":0.6, "p":52.5, "na":4.05, "fe":0.45000002, "se":0.044999998, "mn":0.285}, "mealName":"水果", "mealSort":4, "ingredientList":[{"id":"0", "ingredientId":"775", "ingredientName":"火龙果[仙蜜果、红龙果]", "ingredientTypeId":"0", "ingredientTypeName":"", "amount":150, "diet":{"energy":51, "protein":1.1, "carbohydrate":13.3, "fat":0.2, "fiber":2, "va":0, "vb1":0.03, "vb3":0.22, "ve":0.14, "carotene":0, "vb2":0.02, "vc":3, "ca":7, "k":20, "mg":30, "zn":0.29, "cu":0.04, "i":0.4, "p":35, "na":2.7, "fe":0.3, "se":0.03, "mn":0.19}}]}, {"id":"1355091", "dishName":"芋圆西米露", "dishNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "mealName":"午点", "mealSort":5, "ingredientList":[]}]}, {"cookDate":"2025-05-10", "cookNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "cookPictureList":[], "dishList":[]}, {"cookDate":"2025-05-11", "cookNutrition":{"energy":0, "protein":0, "carbohydrate":0, "fat":0, "fiber":0, "va":0, "vb1":0, "vb3":0, "ve":0, "carotene":0, "vb2":0, "vc":0, "ca":0, "k":0, "mg":0, "zn":0, "cu":0, "i":0, "p":0, "na":0, "fe":0, "se":0, "mn":0}, "cookPictureList":[], "dishList":[]}]}
     */
    public String getMonthMeat(String month, Integer weekNo) {
        try {
            String parameters = "?date=" + month + "&weekNo=" + weekNo;
            String url = monthMeatURL + parameters;
            log.info("url:{}", url);
            return OkHttpUtils.getWithHeaders(url, getHeaders(false));
        } catch (Exception e) {
            throw new MyException(500, e.getMessage());
        }
    }


    private Map<String, String> getHeaders(boolean isNeed) {
        Map<String, String> map = new HashMap<>();

        map.put("bid", "app");
        map.put("authorization", authorization);
        map.put("version", "6.16.2");
        map.put("accept", "application/json, text/plain, */*");
        map.put("host", "kid-app-api.ancda.com");
        map.put("accept-language", "zh_CN");
        if (isNeed) {
            map.put("env", "prod");
            map.put("brand", "2");
            map.put("os", "android");
            map.put("app-type", "3");
            map.put("accept-encoding", "gzip");
            map.put("user-agent", "okhttp/4.9.3");
        }

        log.info("header:{}", JSONObject.toJSONString(map));
        return map;
    }

    public static void main(String[] args) {
//        System.out.println(new AncdaUtil().getMonthMeat("2025-05", 1));
//        System.out.println(new AncdaUtil().getSingleSign("2025-05-08"));
        System.out.println(JSONObject.parse(new AncdaUtil().getMonthSign("2025-05")).get("data"));
//        System.out.println(XxlJobUtil.getWorkDay());
    }

}
